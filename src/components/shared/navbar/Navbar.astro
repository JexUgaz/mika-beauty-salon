---
import type { NavbarItem } from "@/types/NavbarItem";
import NavbarMobile from "@/components/client/NavbarMobile";
import PictureResponsive from "@/components/shared/PictureResponsive.astro";
import { BreakPoints } from "@/types/BreakPoints";
import NavbarDesktop from "./NavbarDesktop.astro";
import ContactNavItem from "./ContactNavItem.astro";

interface Props {
  className?: string;
  useDarkMode?: boolean;
}

const { className = "", useDarkMode = false } = Astro.props as Props;
const pathSegments = Astro.url.pathname.split("/").filter(Boolean);
const currentPath = `/${pathSegments[pathSegments.length - 1] ?? ""}`;

const navItems: NavbarItem[] = [
  { name: "Inicio", href: "/" },
  { name: "Nosotros", href: "/about" },
  {
    name: "Con cada paso soy más yo",
    children: [
      { name: "Mini Documental", href: "/mensaje/parte1" },
      { name: "Testimonios", href: "/mensaje/parte2" },
      { name: "Siente el ritmo", href: "/mensaje/parte2" },
      { name: "Únete al reto", href: "/mensaje/parte2" },
    ],
  },
  {
    name: "Contacto",
    href: "/contact",
    component: ContactNavItem,
  },
];

const baseClass = `
  w-full flex justify-between items-center
  h-[var(--h-navbar-mobile)] lg:h-[var(--h-navbar)]
  px-5 xl:px-10 2xl:px-20
  shadow-md
`;
const darkLogo = "/shared/logo-dark.webp";
const logo = "/shared/logo.webp";
const sources = useDarkMode ? [darkLogo, logo] : [logo];
const breakpoints = useDarkMode ? [BreakPoints.LG] : [];
---

<nav class={`${baseClass} ${className}`}>
  <a href="/" class="h-full">
    <PictureResponsive
      sources={sources}
      breakpoints={breakpoints}
      alt="Mika logo"
      classPicture="flex items-center h-full"
      classImage="w-auto h-[80%]"
    />
  </a>

  <NavbarDesktop navItems={navItems} currentPath={currentPath} />

  <NavbarMobile
    client:load
    items={navItems}
    currentPath={currentPath}
    buttonClasses={`${useDarkMode ? "text-white" : "text-mika-primary"}`}
  />
</nav>
